name: 🚢️ Deploy @ DEV or PREV

on:
  workflow_call:
    inputs:
      version:
        type: string
        default: 'latest'

jobs:
  deploy-dev:
    name: 🚢 Deploy ∷ DEV
    if: ${{ github.ref_name == 'dev' || inputs.version == 'latest' }}
    runs-on: ubuntu-latest
    environment: dev
    env:
      AKS_NAMESPACE: kie-accelerator
    steps:
      - name: Echo Deployment Version
        run: echo "Deploying version '${{ inputs.version }}' to DEV environment."

  deploy-prev:
    name: 🚢 Deploy ∷ PREV
    if: ${{ github.ref_name == 'main' && inputs.version != 'latest' }}
    runs-on: ubuntu-latest
    environment: prev
    env:
      AKS_NAMESPACE: kie-accelerator-prev
    steps:
      - name: Echo Deployment Version
        run: echo "Deploying version '${{ inputs.version }}' to PREV environment."
