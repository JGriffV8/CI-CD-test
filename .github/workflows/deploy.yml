name: üö¢Ô∏è Deploy @ DEV or PREV

on:
  workflow_call:
    inputs:
      version:
        type: string
        default: 'latest'

jobs:
  deploy-dev:
    name: üö¢ Deploy ‚à∑ DEV
    if: ${{ github.ref_name == 'dev' || inputs.version == 'latest' }}
    runs-on: ubuntu-latest
    environment: dev
    env:
      AKS_NAMESPACE: kie-accelerator
    steps:
      - name: Echo Deployment Version
        run: echo "Deploying version '${{ inputs.version }}' to DEV environment."

  deploy-prev:
    name: üö¢ Deploy ‚à∑ PREV
    if: ${{ github.ref_name == 'main' && inputs.version != 'latest' }}
    runs-on: ubuntu-latest
    environment: prev
    env:
      AKS_NAMESPACE: kie-accelerator-prev
    steps:
      - name: Echo Deployment Version
        run: echo "Deploying version '${{ inputs.version }}' to PREV environment."

    outputs:
      deploy-prev-success: ${{ job.status == 'success' }}
